<% content_for :custom_js do %>
  <script type="text/javascript">
    $(document).ready(function(){
      $('.invite_mouse_on').hide();
      
      $('.invite_box').hover(
        function(){ 
          $(this).addClass('invite_box_hover'); 
          $('.invite_mouse_off').hide();
          $('.invite_mouse_on').show();
        },
        function(){
          $(this).removeClass('invite_box_hover'); 
          $('.invite_mouse_off').show();
          $('.invite_mouse_on').hide();
        }
      );
      
      $('.pending_mouse_on').hide();
      
      $('.pending_box').hover(
        function(){ 
          $(this).addClass('pending_box_hover'); 
          $('.pending_mouse_off').hide();
          $('.pending_mouse_on').show();
        },
        function(){
          $(this).removeClass('pending_box_hover'); 
          $('.pending_mouse_off').show();
          $('.pending_mouse_on').hide();
        }
      );
    });
  </script>
<% end %>

<div class="container band_page" style="padding: 60px 15px 0">
  <div class="page-header text-center">
    <h1><%= @band.name %></h1>
  </div>
  
  <div class="band_members container row">
  <% @band.contracts.each do |contract| %>
    <% if contract.approved %>
      <div class="member_box col-md-2 text-center">
        <div class="member_pic text-center">
          <%= image_tag profile_pic('small', contract.user.uid) %>
        </div>
        <h3><%= contract.user.first_name %></h3>
        <p style="color: green;"><em><%= Contract::INSTRUMENTS[contract.instrument] %></em></p>
      </div>
    <% else %>
      <div class="member_box pending_box col-md-2 text-center">
        <div class="pending_mouse_off">
          <div class="member_pic text-center">
            <%= image_tag profile_pic('square', contract.user.uid) %>
          </div>
          <h3><%= contract.user.first_name %></h3>
          <p style="color: green;"><em><%= Contract::INSTRUMENTS[contract.instrument] %></em></p>
        </div>
        <div class="pending_mouse_on">
          <div class="pending_box_actions">
            <%= bootstrap_form_tag url: band_grant_access_path(@band.id) do |f| %>
              <input type="hidden" name="contract_id" value="<%= contract.id %>">
              <%= f.button 'Approve', :name => 'decision', :value=>'approve', :class=> 'btn btn-success', :id => 'btn-add-batch' %>
              <%= f.button 'Reject', :name => 'decision', :value=>'reject', :class=> 'btn btn-danger', :id => 'btn-add-batch' %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>
    
      <div class="member_box invite_box col-md-2 text-center" data-toggle="modal" data-target="#invite_member_div">
        <div class="member_pic text-center">
          <div class="invite_mouse_off">
            <span class="glyphicon glyphicon-user invite_member_hook" aria-hidden="true"></span>
            <div class="invite_member_text">
              <p><em>Missing someone?
              <p>Invite them to join the band!</em></p>
            </div>
          </div>
          <div class="invite_mouse_on">
            <span class="glyphicon glyphicon-plus invite_member_hook" aria-hidden="true"></span>
          </div>
        </div>
      </div>
  </div>
  
  <div id="invite_member_div" class="modal">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title">Invite members</h4>
        </div>
          <div class="modal-body text-center">
            <p class="lead">This your band's invite link:</p>
            <h3 style="margin-bottom: 20px;"><%= link_to invite_url(@band.invite_token), invite_url(@band.invite_token) %></h3>
            <p class="lead">Tell the other members to visit it.</p>
            <p><em> Keep it secret! Anyone with that link will be able to join the band.</em></p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal" tabindex="3">Close</button>
          </div>
      </div>
    </div>
  </div>
  
  <div class="band_summary container">
      <p class="lead"><strong><%= @band.setlist.count %></strong> songs in the setlist.</p>
      <p class="lead">No upcoming concerts.</p>
      <p class="lead">No upcoming rehearsals.</p>
  </div>
</div>